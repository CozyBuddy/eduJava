package days03;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.LinkedHashMap;

import com.util.DBConn;

import domain.DeptEmpSalVo;
import domain.SalgradeVO;

public class Review {
	public static void main(String[] args) {
		String sql ="select s.grade ,s.losal,s.hisal ,count(*) cnt from salgrade s join emp e on  s.losal<= e.sal and s.hisal>=e.sal group by s.grade ,s.losal,s.hisal order by s.grade" ;
		String sqlemp = "select d.deptno,dname,empno,ename,sal from dept d right join emp e on d.deptno = e.deptno join salgrade s on sal between losal and hisal where  grade = ? "; 
		
		Connection conn = null ;
		PreparedStatement pst = null;
		PreparedStatement pst2 = null;
		SalgradeVO vo = null ;
		DeptEmpSalVo des = null ;
		ArrayList<DeptEmpSalVo> al = null ;
		ResultSet rs = null;
		ResultSet rs2 = null;
		LinkedHashMap<SalgradeVO, ArrayList<DeptEmpSalVo>>  lhm= null;
		DBConn.getConnection();
		
		try {
			pst = conn.prepareStatement(sql);
			rs = pst.executeQuery();
			if (rs.next()) {
				int grade = rs.getInt("grade");
				vo = new SalgradeVO(grade, rs.getInt("losal"), rs.getInt("hisal"), rs.getInt("cnt"));
				pst2 = conn.prepareStatement(sqlemp);
				pst2.setInt(1, grade);
				rs2 = pst2.executeQuery();
				if (rs2.next()) {
					al = new ArrayList<DeptEmpSalVo>();
					do {
						des = new DeptEmpSalVo(rs2.getInt("grade"), rs2.getString("dname"), rs2.getString("ename"), grade, null, grade)
					} while (rs2.next());
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
		
	}

}
